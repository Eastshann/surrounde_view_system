# Dahua Surround

一套基于大华鱼眼监控相机的360全景俯视系统

```yaml
|camera 相机图像处理相关代码
|-……
|camera_thread 相机多线程相关代码
|-……
|cfgs 全景俯视相关参数配置
|-……
|test 测试文件
|-……
```

## 核心组件

相机画面捕获线程

捕获线程管理器

相机画面处理线程

处理线程管理器

相机画面处理器

## 使用说明

参考`test1.py`

**Step1.**

根据配置文件创建画面处理器，每个相机配置都不一样。主要有内参、畸变系数、投影变换矩阵等。

**Step2.**

创建画面捕获线程，和捕获线程管理器。并将线程绑定当管理器上。启动所有捕获线程。

管理器的功能，一是同步所有捕获线程，确保读取的是同一时刻的画面，二是将同一时刻的画面载入缓存队列。

**Step3.**

创建画面处理线程，和处理线程管理器。并将线程绑定到管理器。启动所有处理线程。

管理器的功能，一是同步所有处理线程，确保处理的的是同一时刻的画面，二是将同一时刻的处理后的画面载入缓存队列。

**Step4.**

创建合成线程，并启动。合成线程会将处理好的4台相机的鸟瞰图裁剪评价，以及重叠区域融合。并显示融合拼接后的全景俯视图。